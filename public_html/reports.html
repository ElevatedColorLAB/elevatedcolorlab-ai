<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Production Reports</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        html, body { height: 100%; }
        body { font-family: 'Inter', sans-serif; background-color: #0f172a; color: #e2e8f0; }
        .card { background-color: #1e293b; border: 1px solid #334155; border-radius: 0.75rem; }
        .loader { width: 30px; height: 30px; border-radius: 50%; border: 4px solid #334155; border-top-color: #8b5cf6; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body class="h-screen flex flex-col">

    <!-- Navigation Bar -->
    <nav class="bg-slate-900/80 backdrop-blur-md border-b border-slate-700 flex-shrink-0">
        <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center space-x-3">
                        <div class="w-8 h-8 rounded-full bg-gradient-to-tr from-violet-500 to-purple-600"></div>
                        <span class="text-xl font-bold tracking-tight text-white">Production Reports</span>
                    </div>
                    <div class="hidden md:block">
                        <div class="ml-10 flex items-baseline space-x-4">
                            <a href="dashboard.html" class="text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Dashboard</a>
                            <a href="studio.html" class="text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Separation Studio</a>
                             <a href="#" class="bg-gray-800 text-white px-3 py-2 rounded-md text-sm font-medium" aria-current="page">Reports</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-1 p-4 md:p-6 lg:p-8 overflow-y-auto">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-3xl font-bold text-white">Analytics & Insights</h2>
             <button id="generate-summary-btn" class="btn btn-primary"><i class="fas fa-magic mr-2"></i>âœ¨ Generate AI Summary & Recommendations</button>
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- AI Summary Card -->
            <div id="ai-summary-card" class="lg:col-span-3 card p-6 hidden">
                <h3 class="text-xl font-semibold text-white mb-4">AI Analysis</h3>
                <div id="ai-summary-content" class="text-slate-300 space-y-3">
                    <div class="flex items-center justify-center h-24"><div class="loader"></div></div>
                </div>
            </div>

            <!-- Data Cards -->
            <div class="card p-6">
                <h3 class="text-lg font-semibold">Daily Production</h3>
                <p class="text-5xl font-bold mt-4">1,284 <span class="text-lg font-medium text-slate-400">units</span></p>
                <p class="text-green-400 mt-2">+12% from yesterday</p>
            </div>
            <div class="card p-6">
                <h3 class="text-lg font-semibold">Ink Consumption</h3>
                <p class="text-5xl font-bold mt-4">4.2 <span class="text-lg font-medium text-slate-400">gallons</span></p>
                <p class="text-red-400 mt-2">+5% from yesterday</p>
            </div>
            <div class="card p-6">
                <h3 class="text-lg font-semibold">Quality Control</h3>
                <p class="text-5xl font-bold mt-4">98.7% <span class="text-lg font-medium text-slate-400">pass rate</span></p>
                <p class="text-green-400 mt-2">+0.5% from last week</p>
            </div>
        </div>

    </main>
    <script>
        const generateSummaryBtn = document.getElementById('generate-summary-btn');
        const aiSummaryCard = document.getElementById('ai-summary-card');
        const aiSummaryContent = document.getElementById('ai-summary-content');

        generateSummaryBtn.addEventListener('click', () => {
            aiSummaryCard.classList.remove('hidden');
            generateReportSummary();
        });

        async function generateReportSummary() {
            const productionData = {
                dailyProduction: { units: 1284, change: 0.12 },
                inkConsumption: { gallons: 4.2, change: 0.05 },
                qualityControl: { passRate: 0.987, change: 0.005 }
            };

            const prompt = \`
                Analyze the following production report data for a screen printing shop and provide a summary with actionable recommendations.

                **Data:**
                - Daily Production: \${productionData.dailyProduction.units} units (a \${productionData.dailyProduction.change * 100}% increase)
                - Ink Consumption: \${productionData.inkConsumption.gallons} gallons (a \${productionData.inkConsumption.change * 100}% increase)
                - Quality Control: \${productionData.qualityControl.passRate * 100}% pass rate (a \${productionData.qualityControl.change * 100}% increase)

                **Instructions:**
                1.  Provide a brief, high-level summary of the key metrics.
                2.  Identify potential issues or areas for improvement. The increase in ink consumption relative to production might be a key issue.
                3.  Offer 2-3 concrete, actionable recommendations to improve efficiency, reduce costs, or boost quality.
                4.  Format the output as clean HTML with headings and lists.
            \`;
            
            aiSummaryContent.innerHTML = '<div class="flex items-center justify-center h-24"><div class="loader"></div></div>';

            try {
                const apiKey = ""; // Injected by environment
                const apiUrl = \`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=\${apiKey}\`;

                const payload = {
                    contents: [{ parts: [{ text: prompt }] }]
                };

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error('API Error');

                const result = await response.json();
                if (result.candidates && result.candidates.length > 0) {
                    const summaryHtml = result.candidates[0].content.parts[0].text;
                    aiSummaryContent.innerHTML = summaryHtml;
                } else {
                    aiSummaryContent.textContent = 'Could not generate summary.';
                }
            } catch (error) {
                console.error('Error generating summary:', error);
                aiSummaryContent.textContent = 'An error occurred.';
            }
        }
    </script>
</body>
</html>
